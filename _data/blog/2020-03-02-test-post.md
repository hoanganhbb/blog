---
template: BlogPost
path: /new-post
date: 2020-02-01T06:15:50.738Z
title: HÆ°á»›ng dáº«n cÃ i Ä‘áº·t - sá»­ dá»¥ng Jenkins ðŸŽ‰
thumbnail: assets/jenkins.png
metaDescription: df sdf df
---

# HÆ°á»›ng dáº«n setup Jenkins

**YÃªu cáº§u cáº¥u hÃ¬nh:**

- á»” cá»©ng tá»‘i thiá»ƒu: 60Gb
- Há»‡ Ä‘iá»u hÃ nh: Ubuntu 16.04, Ubuntu 18.04
- Git: Bitbucket Server

## CÃ i Ä‘áº·t jenkins

```
wget -q -O - http://pkg.jenkins-ci.org/debian/jenkins-ci.org.key | sudo apt-key add -
```

Khi thÃªm key xong thÃ¬ há»‡ thá»‘ng sáº½ tráº£ vá» OK

```
sudo sh -c 'echo deb http://pkg.jenkins-ci.org/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'
```

```
sudo apt update
```

```
sudo apt install jenkins
```

<br>

## Khá»Ÿi cháº¡y jenkins

- ### Khá»Ÿi cháº¡y há»‡ thá»‘ng jenkins

```
sudo systemctl start jenkins
```

- ### Kiá»ƒm tra tráº¡ng thÃ¡i cá»§a há»‡ thá»‘ng jenkins

```
sudo systemctl status jenkins
```

<br>

## Má»Ÿ port truy cáº­p jenkins

Máº·c Ä‘á»‹nh khi cÃ i Ä‘áº·t xong jenkins cháº¡y á»Ÿ 8080. VÃ¬ váº­y sáº½ má»Ÿ cá»•ng 8080

```
sudo ufw allow 8080
```

Kiá»ƒm tra tráº¡ng thÃ¡i firewall

```
sudo ufw status
```

_Náº¿u firewall á»Ÿ tráº¡ng thÃ¡i inactive. Thá»±c hiá»‡n nhÆ° sau Ä‘á»ƒ má»Ÿ firewall_

```
sudo ufw allow OpenSSH
sudo ufw enable
```

<br>

## Cáº¥u hÃ¬nh Jenkins

Äá»ƒ cáº¥u hÃ¬nh Ä‘Æ°á»£c jenkins, ta truy cáº­p vÃ o trang "http://your_server_ip_or_domain:8080"

ÄÃ¢y lÃ  mÃ n hÃ¬nh Ä‘áº§u tiÃªn khi báº¯t Ä‘áº§u cháº¡y jenkins. Äá»ƒ láº¥y Ä‘Æ°á»£c máº­t kháº©u, truy cáº­p vÃ o

```
sudo cat /var/lib/jenkins/secrets/initialAdminPassword
```

![Unlock_Jenkins](https://assets.digitalocean.com/articles/jenkins-install-ubuntu-1604/unlock-jenkins.png)

Nháº­p password => Nháº¥n chá»n Continue => CÃ i Ä‘áº·t cÃ¡c plugins há»— trá»£

![Unlock_Jenkins](https://assets.digitalocean.com/articles/jenkins-install-ubuntu-1804/customize_jenkins_screen_two.png)

=> Chá»n Install Suggested Plugins

![Unlock_Jenkins](https://assets.digitalocean.com/articles/jenkins-install-ubuntu-1804/jenkins_plugin_install_two.png)

- Khá»Ÿi táº¡o tÃ i khoáº£n admin

![Unlock_Jenkins](https://assets.digitalocean.com/articles/jenkins-install-ubuntu-1804/jenkins_create_user.png)

Äiá»n username, password, email... cá»§a admin

![Unlock_Jenkins](https://assets.digitalocean.com/articles/jenkins-install-ubuntu-1804/instance_confirmation.png)

Nháº­p domain Ä‘áº·t jenkins (Náº¿u chÆ°a cÃ³ domain cÃ³ thá»ƒ Ä‘iá»n IP server)

=> LÆ°u vÃ  káº¿t thÃºc cÃ i Ä‘áº·t. VÃ o trang chá»§ Jenkins

![Unlock_Jenkins](https://assets.digitalocean.com/articles/jenkins-install-ubuntu-1804/jenkins_home_page.png)

---

# HÆ°á»›ng dáº«n cÃ i Ä‘áº·t Jenkins vá»›i Bitbucket

## CÃ i Ä‘áº·t cÃ¡c plugins há»— trá»£ Bitbucket

- Truy cáº­p vÃ o Manage Jenkins => Manage Plugins

![Unlock_Jenkins](assets/jenkins.png)

**Nhá»¯ng plugins cáº§n cÃ i Ä‘áº·t**

![Unlock_Jenkins](assets/Screen Shot 2020-12-21 at 18.21.24.png)
![Unlock_Jenkins](assets/Screen Shot 2020-12-21 at 18.21.40.png)
![Unlock_Jenkins](assets/Screen Shot 2020-12-21 at 18.21.49.png)

## Káº¿t ná»‘i Bitbucket

VÃ o trang Manage Jenkins => Chá»n Configure System

![Unlock_Jenkins](assets/Screen Shot 2020-12-21 at 18.25.37.png)

Nháº­p cÃ¡c thÃ´ng tin cáº§n thiáº¿t

- Instance name: Bitbuket Server
- Instance URL: { Äá»‹a chá»‰ Bitbucket } (vd: https://sdss.bkav.com/)
- Personal access token: Sá»­ dá»¥ng token key cá»§a user admin Bitbucket

![Unlock_Jenkins](assets/Screen Shot 2020-12-21 at 18.29.26.png)

=> Khi nháº­p xong, nháº¥n button Test connection

Náº¿u connect thÃ nh cÃ´ng thÃ¬ sáº½ cÃ³ thÃ´ng bÃ¡o

![Unlock_Jenkins](assets/Screen Shot 2020-12-21 at 18.32.24.png)

CÃ i Ä‘áº·t Bitbucket Endpoint

![Unlock_Jenkins](assets/Screen Shot 2020-12-21 at 18.37.39.png)

=> CÃ i Ä‘áº·t xong chá»n LÆ°u (Save)

---

# Táº¡o CI/CD cho project

## CÃ i Ä‘áº·t trÃªn há»‡ thá»‘ng Jenkins

- Chá»n New Item

![Unlock_Jenkins](assets/Screen Shot 2020-12-21 at 18.41.15.png)

- Äiá»n tÃªn Project
- Chá»n Pipeline => Chá»n OK

![Unlock_Jenkins](assets/Screen Shot 2020-12-21 at 18.45.29.png)

- Chá»n Bitbucket Server trigger build after push

![Unlock_Jenkins](assets/Screen Shot 2020-12-21 at 18.47.48.png)

- CÃ i Ä‘áº·t Pipeline (Thá»±c thi quÃ¡ trÃ¬nh CI)

![Unlock_Jenkins](assets/Screen Shot 2020-12-21 at 18.53.07.png)

- Credentials (for build auth): XÃ¡c thá»±c tÃ i khoáº£n Bitbucket
- Bitbucket Server instance: Bitbucket Server
- Project name: { TÃªn Project trong Bitbucket}
- Repository name: { TÃªn repo trong Bitbucket}
- Branches to build: Branch cáº§n láº¥y Ä‘á»ƒ deploy (ThÆ°á»ng lÃ  master hay develop)
- Script Path: TÃªn file jenkins: File nÃ y sáº½ lÃ  file náº±m trong code. Sau khi connect Ä‘Æ°á»£c vá»›i repo thÃ¬ jenkins sáº½ thá»±c thi lá»‡nh trong jenkinsfile (tÃªn default cá»§a file: jenkinsfile)

=> Sau khi nháº­p thÃ´ng tin xong, nháº¥n Test connection Ä‘á»ƒ Ä‘áº£m báº£o káº¿t ná»‘i. Káº¿t ná»‘i thÃ nh cÃ´ng há»‡ thá»‘ng sáº½ bÃ¡o:
_"Jenkins successfully connected to Bitbucket Server's"_

## CÃ i Ä‘áº·t Code dá»± Ã¡n

- Táº¡o file _jenkinsfile_ náº±m trong thÆ° má»¥c gá»‘c cá»§a dá»± Ã¡n
- File jenkinsfile máº«u vá»›i code FE

```
pipeline {
     agent any
     tools {nodejs "node"}
     stages {
        stage("Build") {
            steps {
                sh "npm install"
                sh "npm run build"
            }
        }
    }
}
```
